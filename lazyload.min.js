!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(window.jQuery||window.Zepto)}(function(d,e){function h(){}function s(e,t){return(t._$container==g?("innerHeight"in A?A.innerHeight:g.height())+g.scrollTop():t._$container.offset().top+t._$container.height())<=e.offset().top-t.threshold}function u(e,t){return(t._$container==g?g.scrollTop():t._$container.offset().top)>=e.offset().top+t.threshold+e.height()}function a(c,f){var _=0;c.each(function(e,t){function a(){i.trigger("_lazyload_appear"),_=0}var r,n,o,l,i=c.eq(e);if(!(i.width()<=0&&i.height()<=0||"none"===i.css("display")))if(f.vertical_only)if(u(i,f));else if(s(i,f)){if(++_>f.failure_limit)return!1}else a();else if(u(i,f)||(o=i,((l=f)._$container==g?d.fn.scrollLeft?g.scrollLeft():A.pageXOffset:l._$container.offset().left)>=o.offset().left+l.threshold+o.width()));else if(s(i,f)||(r=i,((n=f)._$container==g?g.width()+(d.fn.scrollLeft?g.scrollLeft():A.pageXOffset):n._$container.offset().left+n._$container.width())<=r.offset().left-n.threshold)){if(++_>f.failure_limit)return!1}else a()})}function p(a){return a.filter(function(e,t){return!a.eq(e)._lazyload_loadStarted})}var r,t,A=window,g=d(A),n={threshold:0,failure_limit:0,event:"scroll",effect:"show",effect_params:null,container:A,data_attribute:"original",data_srcset_attribute:"original-srcset",skip_invisible:!0,appear:h,load:h,vertical_only:!1,check_appear_throttle_time:300,url_rewriter_fn:h,no_fake_img_loader:!1,placeholder_data_img:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC",placeholder_real_img:"http://ditu.baidu.cn/yyfm/lazyload/0.0.1/img/placeholder.png"};t=Object.prototype.toString,r=function(e){return t.call(e).replace("[object ","").replace("]","")},d.fn.hasOwnProperty("lazyload")||(d.fn.lazyload=function(f){var e,_,t,s=this;return d.isPlainObject(f)||(f={}),d.each(n,function(e,t){-1!=d.inArray(e,["threshold","failure_limit","check_appear_throttle_time"])?"String"==r(f[e])?f[e]=parseInt(f[e],10):f[e]=t:"container"==e?(f.hasOwnProperty(e)?f[e]==A||f[e]==document?f._$container=g:f._$container=d(f[e]):f._$container=g,delete f.container):!n.hasOwnProperty(e)||f.hasOwnProperty(e)&&r(f[e])==r(n[e])||(f[e]=t)}),e="scroll"==f.event,t=0==f.check_appear_throttle_time?a:function(e,t){function a(){l=0,i=+new Date,o=e.apply(r,n),n=r=null}var r,n,o,l,i=0;return function(){r=this,n=arguments;var e=new Date-i;return l||(t<=e?a():l=setTimeout(a,t-e)),o}}(a,f.check_appear_throttle_time),_=e||"scrollstart"==f.event||"scrollstop"==f.event,s.each(function(e,t){var r=this,n=s.eq(e),a=n.attr("src"),o=n.attr("data-"+f.data_attribute),l=f.url_rewriter_fn==h?o:f.url_rewriter_fn.call(r,n,o),i=n.attr("data-"+f.data_srcset_attribute),c=n.is("img");return 1==n._lazyload_loadStarted||a==l?(n._lazyload_loadStarted=!0,void(s=p(s))):(n._lazyload_loadStarted=!1,c&&!a&&n.one("error",function(){n.attr("src",f.placeholder_real_img)}).attr("src",f.placeholder_data_img),n.one("_lazyload_appear",function(){function e(){t&&n.hide(),c?(i&&n.attr("srcset",i),l&&n.attr("src",l)):n.css("background-image",'url("'+l+'")'),t&&n[f.effect].apply(n,a?f.effect_params:[]),s=p(s)}var t,a=d.isArray(f.effect_params);n._lazyload_loadStarted||(t="show"!=f.effect&&d.fn[f.effect]&&(!f.effect_params||a&&0==f.effect_params.length),f.appear!=h&&f.appear.call(r,n,s.length,f),n._lazyload_loadStarted=!0,f.no_fake_img_loader||i?(f.load!=h&&n.one("load",function(){f.load.call(r,n,s.length,f)}),e()):d("<img />").one("load",function(){e(),f.load!=h&&f.load.call(r,n,s.length,f)}).attr("src",l))}),void(_||n.on(f.event,function(){n._lazyload_loadStarted||n.trigger("_lazyload_appear")})))}),_&&f._$container.on(f.event,function(){t(s,f)}),g.on("resize load",function(){t(s,f)}),d(function(){t(s,f)}),this})});